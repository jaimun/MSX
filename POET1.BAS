10 REM      POET GEN
20 '
30 '
35 CLEAR 10000
40 DIM N$(7,50):DIM X$(50)
50 DIM F(7):DIM D$(3,50)
60 GOSUB 9300
90 '
100 '         MENU
110 WIDTH(30):COLOR 5,1,1:SCREEN 0
120 KEY OFF:LOCATE 0,6
130 PRINT"     1  CREAR FICHEROS"
140 PRINT"     2  MODIFICAR FICHEROS"
150 PRINT"     3  POETIZADOR"
160 PRINT"     4  CARGA VAR"
200 A$=INKEY$:IF A$="" THEN 200
210 A=ASC(A$)-48:BEEP
220 IF A<1 OR A>4 THEN 200
230 ON A GOTO 1000,2000,3000,9000
1000 '    CREAR FICHEROS
1010 CLS
1020 LOCATE 0,6
1030 PRINT"      1  NOMBRES"
1040 PRINT"      2  ADJETIVOS"
1050 PRINT"      3  VERBOS"
1060 PRINT"      4  ORACIONES"
1070 PRINT"      5  CONJUNCIONES"
1080 PRINT"      6  PREPOSICIONES"
1090 PRINT"      7  ADVERBIOS"
1100 PRINT"      8  MAIN MENU"
1200 A$=INKEY$:IF A$="" THEN 1200
1210 A=ASC(A$)-48:BEEP
1220 IF A<1 OR A>8 THEN 1200
1230 ON A GOTO 1310,1320,1330,1340,1350,1360,1370,100
1310 T$="NOM":T=1:GOTO 1400
1320 T$="ADJ":T=2:GOTO 1400
1330 T$="VER":T=3:GOTO 1400
1340 T$="ORA":T=4:GOTO 1400
1350 T$="CON":T=5:GOTO 1400
1360 T$="PRE":T=6:GOTO 1400
1370 T$="ADV":T=7:GOTO 1400
1400 N=0
1410 CLS:LOCATE 10,0:PRINT"TIPO: ";T$
1430 LOCATE 6,2:PRINT N;" introducidos"
1440 LOCATE 0,4:PRINT"NUEVO DATO ":INPUT P$
1450 IF P$="Q" OR PN=50 THEN BEEP: GOTO 1500
1460 N=N+1:X$(0)=STR$(N):X$(N)=LEFT$(P$,25)
1470 GOTO 1410
1500 '
1510 CLS:PRINT"GRABAR, CONTINUAR O SALIR?    (G/C/M)"
1515 A$=INKEY$:IF A$<>"" THEN 1515
1520 A$=INKEY$:IF A$="" THEN 1520
1530 IF A$="c" OR A$="C" THEN  GOTO 1410
1531 IF A$="m" OR A$="M" THEN  GOTO 100
1535 IF A$="g" OR A$="G" THEN  GOTO 1540 ELSE 1520
1540 INPUT "NOMBRE ";N$
1545 IF N$=""THEN 1540
1550 A$=LEFT$(N$,8)+"."+T$
1560 OPEN "A:"+A$ AS#1
1570 FIELD#1,25 AS X$
1575 LSET X$=X$(0):PUT#1,1
1580 FOR F=2 TO 51
1590 LSET X$=X$(F-1)
1600 PUT#1,F
1610 NEXT F
1620 CLOSE#1
1630 GOTO 100
2000 '    MODIFICAR
2010 CLS
2015 PRINT" NOM ADJ VER ADV PRE CON ORA M"
2020 LOCATE 0,6
2030 INPUT"TIPO DE FICHERO";A$
2031 IF A$="m" OR A$="M" THEN 100
2040 IF A$<>"NOM" AND A$<>"ADJ" AND A$<>"ADV" AND A$<>"VER" AND A$<>"CON" AND A$<>"PRE" AND A$<>"ORA" THEN 2000
2050 CLS:A$="."+A$:FILES "*"+A$:PRINT
2060 INPUT"FICHERO";F$
2065 F$=F$+A$
2070 OPEN F$ AS#1
2080 FIELD #1,25 AS X$
2090 GET #1,1
2100 N=VAL(X$)
2110 CLS
2130 IF A$=".NOM" THEN T=1
2140 IF A$=".ADJ" THEN T=2
2150 IF A$=".VER" THEN T=3
2160 IF A$=".ORA" THEN T=4
2170 IF A$=".CON" THEN T=5
2175 IF A$=".PRE" THEN T=6
2180 IF A$=".ADV" THEN T=7
2185 F(T)=1
2190 FOR F=2 TO 51
2200 GET #1,F
2205 N$(T,F-1)=X$
2210 NEXT F
2220 CLOSE
2230 F=1
2235 PRINT"FICHERO ";F$
2240 PRINT N;" DATOS"
2250 LOCATE 0,6
2260 PRINT "DATO ";F;": ";N$(T,F)
2265 IF STRIG(0)<>0 THEN 2310
2270 A=STICK(0):IF A=0 THEN 2265
2280 IF A=1 AND F>1 THEN F=F-1
2290 IF A=5 AND F<50 THEN F=F+1
2295 LOCATE 0,6:PRINT"                              "
2296 IF STICK(0)<>0 THEN 2296
2300 GOTO 2250
2306 LOCATE 0,6
2310 INPUT "NUEVO DATO";N$
2320 IF N$="Q" THEN 2400
2321 IF N$="m" OR N$="M" THEN 100
2325 IF F>N+1 THEN F=N+1:N=N+1
2330 N$(T,F)=N$
2335 LOCATE0,7:PRINT"                              "
2340 CLS:GOTO 2235
2400 OPEN F$+"."+A$ AS#1
2410 FIELD #1,25 AS X$
2420 FOR F=2 TO 51
2430 LSET X$=N$(T,F-1):PUT #1,F
2440 NEXT F
2450 CLOSE
2500 GOTO 100
3000 '     POETIZER
3010 CLS
3020 LOCATE 0,6
3030 PRINT"     1  CREAR"
3040 PRINT"     2  CARGAR FICHERO"
3050 PRINT"     3  MAIN MENU"
3100 A$=INKEY$:IF A$="" THEN 3100
3110 A=ASC(A$)-48:BEEP
3120 IF A<1 OR A>3 THEN 3100
3130 ON A GOTO 4000,3200,100
3200 '       CARGAR
3205 CLS:PRINT" NOM ADJ VER ADV PRE CON ORA ":LOCATE 0,6
3210 INPUT"TIPO DE FICHERO";A$
3220 IF A$<>"NOM" AND A$<>"ADJ" AND A$<>"ADV" AND A$<>"VER" AND A$<>"CON" AND A$<>"PRE" AND A$<>"ORA" THEN 3200
3230 CLS:A$="."+A$:FILES "*"+A$:PRINT
3240 INPUT"FICHERO";F$
3250 F$=F$+A$
3260 OPEN F$ AS#1
3270 FIELD #1,25 AS X$
3280 GET #1,1
3290 N=VAL(X$)
3310 IF A$=".NOM" THEN T=1
3320 IF A$=".ADJ" THEN T=2
3330 IF A$=".VER" THEN T=3
3340 IF A$=".ORA" THEN T=4
3350 IF A$=".CON" THEN T=5
3360 IF A$=".PRE" THEN T=6
3370 IF A$=".ADV" THEN T=7
3380 F(T)=1
3390 FOR F=2 TO 51
3400 GET #1,F
3410 N$(T,F-1)=X$
3420 NEXT F
3430 CLOSE
3440 GOTO 3000
4000 ' CREAR
4001 LPRINT CHR$(27);CHR$(108);CHR$(10);
4002 LPRINT CHR$(27);CHR$(81);CHR$(40);
4005 CLS
4006 P$=""
4010 LO=VAL(N$(4,0))
4020 RO=INT(RND(1)*LO)+1
4030 O$=N$(4,RO)
4040 IF LEN(O$)>0 AND MID$(O$,LEN(O$),1)=" "THEN O$=LEFT$(O$,LEN(O$)-1):GOTO 4040
4045 NN=0
4050 FOR F=1 TO LEN(O$)
4060 T$=MID$(O$,F,1)
4070 IF T$="N" THEN T=1:NN=NN+1
4080 IF T$="A" THEN T=2
4090 IF T$="V" THEN T=3:NN=0
4100 IF T$="C" THEN T=5
4110 IF T$="P" THEN T=5
4120 IF T$="D" THEN T=6
4200 GOSUB4500
4210 NEXT F
4215 PRINTP$
4240 IF INKEY$="" THEN A=RND(1):GOTO 4240
4245 LPRINT P$
4250 GOTO 3000
4500 '  FRASE
4510 LO=VAL(N$(T,0))
4520 RO=INT(RND(1)*LO)+1
4530 A$=N$(T,RO)
4535 LF=LEN(A$):IF LF>0 THEN IF MID$(A$,LF,1)=" "THEN A$=LEFT$(A$,(LF-1)):GOTO 4535
4536 IF T=1 THEN GOSUB 5000
4537 IF T=2 THEN GOSUB 5500
4538 'PRINTA$;" ";
4539 P$=P$+A$+" "
4540 RETURN
5000 ' NOM
5010 G$=RIGHT$(A$,1)
5020 IF G$="0" THEN GE=0
5030 IF G$="1" THEN GE=1
5040 A$=LEFT$(A$,LEN(A$)-1)
5044 IF NU=1 AND RIGHT$(A$,1)<>"A" AND RIGHT$(A$,1)<>"O" THEN A$=A$+"E"
5045 IF NU=1 THEN A$=A$+"S"
5046 GOSUB6000
5050 RETURN
5500 '  ADJ+GEN
5505 IF RIGHT$(A$,1)="L" OR RIGHT$(A$,1)="Z" OR RIGHT$(A$,1)="R" THEN 5540
5506 IF RIGHT$(A$,1)="E" THEN 5525
5507 A$=LEFT$(A$,LEN(A$)-1)
5510 IF GE=1 OR GE=3 THEN A$=A$+"O"
5520 IF GE=0 OR GE=2 THEN A$=A$+"A"
5525 IF NU=1 THEN A$=A$+"S"
5530 RETURN
5540 IF NU=1 THEN A$=A$+"ES":RETURN
6000 '  DETERMINANTE
6001 NU=INT(RND(1)*2)
6005 IF NU=1 THEN GE=GE+2
6010 LO=VAL(D$(GE,0)):RO=INT(RND(1)*LO)+1
6020 A$=D$(GE,RO)+" "+A$
6030 RETURN
9000 '   CARGA VAR
9001 RESTORE 9200
9005 FOR G=1 TO 3:READ A$:F$="VAR"+A$
9010 OPEN F$ AS#1
9020 FIELD #1,25 AS X$
9030 GET #1,1
9040 N=VAL(X$)
9045 N$(G,0)=X$
9050 IF A$=".NOM" THEN T=1
9060 IF A$=".ADJ" THEN T=2
9070 IF A$=".ADV" THEN T=3
9080 IF A$=".CON" THEN T=4
9090 IF A$=".VER" THEN T=5
9100 IF A$=".PRE" THEN T=6
9110 IF A$=".ORA" THEN T=7
9130 FOR F=2 TO 51
9140 GET #1,F
9150 N$(G,F-1)=X$
9160 NEXT F
9170 CLOSE
9180 NEXT G:BEEP:BEEP:GOTO 100
9200 DATA".NOM",".ADJ",".VER"
9300 '  PRE CON
9310 RESTORE 9360
9320 FOR F=1 TO 19
9330 READ N$(6,F)
9340 NEXT F
9350 N$(6,0)="19"
9360 DATA "A","ANTE","BAJO","CABE","CON","CONTRA","DE","DESDE","EN","ENTRE","HACIA","HASTA","PARA","POR","SEGUN","SIN","SO","SOBRE","TRAS"
9370 RESTORE 9420
9380 FOR F=1 TO 8
9390 READ N$(4,F)
9400 NEXT F
9410 N$(4,0)="8"
9420 DATA "NV","NAV","NAC.NAV","VCVNA","NAV.N.PN","NA.PNAV.N.PN","PVCVNA","ACACANV.N.PNC.PN"
9450 N$(5,0)="1"
9460 N$(5,1)="Y"
9470 RESTORE 9530
9480 FOR F=0 TO 3
9485 FOR G=1 TO 6
9490 READ D$(F,G)
9500 NEXT G
9510 NEXT F
9520 D$(0,0)="6":D$(1,0)="6"
9530 DATA "LA","ESA","ESTA","AQUELLA","UNA","LA"
9540 DATA "EL","ESE","ESTE","AQUEL","UN","EL"
9550 DATA "LAS","ESAS","ESTAS","AQUELLAS","UNAS","LAS"
9560 DATA "LOS","ESOS","ESTOS","AQUELLOS","UNOS","LOS"
9999 RETURN
