1 ' version screen 8, 9-2-90
2 GOTO 10000
10 ' SUB ID
15 ST=0
20 IF STRIG(0) OR STRIG(1) THEN ST=1:RETURN
30 IF STRIG(3) OR STRIG(4) OR INKEY$=CHR$(13) THEN ST=2:RETURN
40 ON ID GOSUB 100,200,300
50 RETURN
100 ' CURSOR - JOYSTICK
110 XV=XC:YV=YC:A=STICK(0) OR STICK(1):IF A=0 THEN RETURN
120 XC=XC+IC*((A=6)OR(A=7)OR(A=8))-IC*((A=2)OR(A=3)OR(A=4))
130 YC=YC+IC*((A=8)OR(A=1)OR(A=2))-IC*((A=4)OR(A=5)OR(A=6))
140 IF XC>ME OR XC<MO OR YC>MS OR YC<MN THEN XC=XV:YC=YV
150 PUT SPRITE 0,(XC-4,YC-4),CC
190 RETURN
200 ' RATON
210 A=PAD(12)
220 XV=XC:YV=YC
230 XC=XC+PAD(13)/4:YC=YC+PAD(14)/4
240 IF XC>ME OR XC<MO OR YC>MS OR YC<MN THEN XC=XV:YC=YV
250 PUT SPRITE 0,(XC-4,YC-4),CC
260 RETURN
300 ' TABLETA GRAFICA
399 ' LINEA
400 ON TP GOTO 410,420,440,470,480,490
410 LINE(XV,YV)-(XC,YC),CO:RETURN
420 LINE(XV,YV)-(XC,YC),CO:LINE(XV+1,YV)-(XC+1,YC),CO
430 LINE(XV,YV+1)-(XC,YC+1),CO:LINE(XV+1,YV+1)-(XC+1,YC+1),CO:RETURN
440 LINE(XV,YV)-(XC,YC),CO
450 LINE(XV+1,YV)-(XC+1,YC),CO:LINE(XV-1,YV)-(XC-1,YC),CO
460 LINE(XV,YV+1)-(XC,YC+1),CO:LINE(XV,YV-1)-(XC,YC-1),CO:RETURN
470 LINE(XV-1,YV-1)-(XC-1,YC-1),CO:LINE(XV+1,YV-1)-(XC+1,YC-1),CO:LINE(XV-1,YV+1)-(XC-1,YC+1),CO:LINE(XV+1,YV+1)-(XC+1,YC+1),CO:GOTO 440
480 LINE(XV-2,YV)-(XC-2,YC),CO:LINE(XV+2,YV)-(XC+2,YC),CO:LINE(XV,YV+2)-(XC,YC+2),CO:LINE(XV,YV-2)-(XC,YC-2),CO:GOTO 470
490 LINE(XV-2,YV-1)-(XC-2,YC-1),CO:LINE(XV+2,YV+1)-(XC+2,YC+1),CO:LINE(XV-1,YV+2)-(XC-1,YC+2),CO:LINE(XV+1,YV-2)-(XC+1,YC-2),CO
500 LINE(XV+2,YV-1)-(XC+2,YC-1),CO:LINE(XV-2,YV+1)-(XC-2,YC+1),CO:LINE(XV-1,YV-2)-(XC-1,YC-2),CO:LINE(XV+1,YV+2)-(XC+1,YC+2),CO:GOTO 480
1000 ' DIBUJO
1010 ON ID GOSUB 100,200,300
1020 IF STRIG(0) OR STRIG(1) THEN GOSUB 400
1030 IF STRIG(3) OR STRIG(4) OR INKEY$=CHR$(13) THEN PUT SPRITE 0,(0,212):RETURN
1040 GOTO 1010
1100 ' 1§ PUNTO
1110 GOSUB 10
1120 IF ST=1 THEN XL=XC:YL=YC:PUT SPRITE 31,(XL-4,YL-4),9,0:GOTO 1150
1130 IF ST=2 THEN PUT SPRITE 31,(0,212):PUT SPRITE 0,(0,212):RETURN
1140 GOTO 1110
1150 IF STRIG(0) OR STRIG(1) THEN 1150
1160 RETURN
1200 ' 2 PUNTOS
1210 GOSUB 1100
1220 GOSUB 10
1230 PUT SPRITE 1,(XC-4,YL-4),9,0:PUT SPRITE 2,(XL-4,YC-4),9,0
1240 IF ST=1 THEN 1310
1250 IF ST=2 THEN 1310
1260 GOTO 1220
1310 PUT SPRITE 0,(0,212):PUT SPRITE 1,(0,212):PUT SPRITE 2,(0,212):PUT SPRITE 31,(0,212)
1320 RETURN
1500 ' LINEAS
1510 LR=1
1520 NL=0:GOSUB 1100
1530 GOSUB 10
1540 IF ST=1 THEN 1570
1550 IF ST=2 THEN PUT SPRITE 31,(0,212):PUT SPRITE 0,(0,212):RETURN
1560 GOTO 1530
1570 XV=XL:YV=YL:GOSUB 400:NL=NL+1
1580 PUT SPRITE 31,(0,212)
1590 IF STRIG(0) OR STRIG(1) THEN 1590
1600 IF LR=1 THEN GOTO 1500 ELSE RETURN
1900 ' TIPO DE PUNTO
1910 A$="262728293031":GOSUB 9000
1920 TP=MC:RETURN
2200 ' QUIT
2210 CLS:END
2300 ' COGE COLOR
2310 GOSUB 10
2320 IF ST=2 THEN RETURN
2330 IF ST=1THEN CO=POINT(XC,YC):RETURN
2340 GOTO 2310
2400 ' FULL VIEW
2410 IF STRIG(0) OR STRIG(1) THEN RETURN ELSE 2410
2500 ' POLIGONO
2510 LR=0:XL=XC:YL=YC:GOSUB 1520
2515 IF NL=0 THEN RETURN
2520 XO=XL:YO=YL
2530 XL=XC:YL=YC:PUT SPRITE 31,(XL-4,YL-4),9,0:GOSUB 1530
2540 IF STRIG(3) OR STRIG(4) THEN XV=XO:YV=YO:XC=XL:YC=YL:GOSUB 400: ELSE 2530
2550 RETURN
2600 ' POLILINEA
2610 LR=0:XL=XC:YL=YC:GOSUB 1520
2620 IF NL=0 THEN RETURN
2640 XL=XC:YL=YC:PUT SPRITE 31,(XL-4,YL-4),9,0:GOSUB 1530
2650 IF STRIG(3) OR STRIG(4) THEN RETURN
2660 GOTO 2640
2700 'ABANICO
2710 LR=0:XL=XC:YL=YC:GOSUB 1520
2720 IF NL=0 THEN RETURN
2740 PUT SPRITE 31,(XL-4,YL-4),9,0:GOSUB 1530
2750 IF STRIG(3) OR STRIG(4) THEN RETURN
2760 GOTO 2740
2800 ' FILL
2810 GOSUB 10
2820 IF ST=1 THEN GOTO 2850
2830 IF ST=2 THEN RETURN
2840 GOTO 2810
2850 ON TF GOTO 2860
2860 PAINT(XC,YC),CO
2870 GOTO 2810
2900 ' CIRCULO
2910 GOSUB 1200
2920 CIRCLE (XL,YL),ABS(XL-XC),CO
2930 RETURN
3000 ' CUADRADO
3010 GOSUB 1200
3015 IF ST=2 THEN RETURN
3020 XV=XL:YV=YL:XO=XC:YO=YC
3030 YC=YV:GOSUB 400
3040 XV=XC:YC=YO:GOSUB 400
3050 XV=XL:YV=YC:GOSUB 400
3060 XC=XL:YV=YL:GOSUB400
3070 XC=XL:YC=YL
3080 GOTO 3000
3100 ' COGE COPY
3110 GOSUB 1200
3115 IF XC>XL THEN SWAP XC,XL
3116 IF YC>YL THEN SWAP YC,YL
3117 XW=XL-XC:YW=YL-YC
3120 COPY (XC,YC)-(XL,YL),PG TO (0,0),1
3130 RETURN
3200 ' PONE COPY
3210 GOSUB 10
3220 IF ST=1 THEN 3250
3230 IF ST=2 THEN RETURN
3240 GOTO 3210
3250 IF XC+XW>255 THEN XL=255-XC ELSE XL=XW
3251 IF YC+YW>211 THEN YL=211-YC ELSE YL=YW
3269 ON OL GOTO 3270,3271,3272,3273,3274,3275,3276,3277,3278,3279
3270 COPY (0,0)-(XL,YL),1 TO (XC,YC),PG,PSET:GOTO 3280
3271 COPY (0,0)-(XL,YL),1 TO (XC,YC),PG,PRESET:GOTO 3280
3272 COPY (0,0)-(XL,YL),1 TO (XC,YC),PG,XOR:GOTO 3280
3273 COPY (0,0)-(XL,YL),1 TO (XC,YC),PG,OR:GOTO 3280
3274 COPY (0,0)-(XL,YL),1 TO (XC,YC),PG,AND:GOTO 3280
3275 COPY (0,0)-(XL,YL),1 TO (XC,YC),PG,TPSET:GOTO 3280
3276 COPY (0,0)-(XL,YL),1 TO (XC,YC),PG,TPRESET:GOTO 3280
3277 COPY (0,0)-(XL,YL),1 TO (XC,YC),PG,TXOR:GOTO 3280
3278 COPY (0,0)-(XL,YL),1 TO (XC,YC),PG,TOR:GOTO 3280
3279 COPY (0,0)-(XL,YL),1 TO (XC,YC),PG,TAND
3280 GOTO 3210
3300 ' SET PAGE
3310 PG=PG+1:IF PG=2 THEN PG=0
3320 SET PAGE PG,PG
3330 RETURN
3400 ' MENU ID
3410 A$="12131406":GOSUB 9000
3420 IF MC=4 OR MC=3 THEN RETURN
3430 ID=MC:RETURN
3500 ' ELIGE COLOR
3510 MD=INT((((ABS(132-246)+1)*(ABS(2-84)+1)*8+7)/8+4)/2)+1
3520 ERASE P%:DIM P%(MD)
3530 COPY (132,2)-(246,84) TO P%
3540 GOSUB 4000
3550 GOSUB 2300
3560 COPY P% TO (132,2)
3570 RETURN
3600 ' MENU OPERACION LOGICA
3610 A$="46474849505152535455":GOSUB 9000
3620 OL=MC:GOTO 3200
3900 ' CLS
3905 COLOR255,109,3:CLS
3920 RETURN
4000 ' PALETA DE COLORES SCREEN 8
4020 FOR F=0 TO 3
4030 IF (F=0 OR F=2) THEN X=130 ELSE X=186
4040 IF (F=0 OR F=1) THEN Y=0 ELSE Y=40
4050 FOR G=0 TO 7
4060 FOR H=0 TO 7
4070 CX=X+G*7
4080 CY=Y+H*5
4090 CL=32*G+4*H+F
4100 LINE(CX+2,CY+2)-STEP(6,4),CL,BF
4110 NEXT H,G,F
4120 RETURN
5000 ' MAIN MENU
5010 A$="01180809":GOSUB 9000
5020 IF MC=0 THEN GOTO 2200
5030 DO=1
5040 ON MC GOSUB 5100,5200,3400,6000
5050 GOTO 5000
5100 ' MENU DIBUJO
5110 A$="33026005343536193738073917404142"
5130 GOSUB 9000
5140 IF MC=0 THEN RETURN
5150 ON MC GOSUB 1000,1500,2300,1900,2500,2600,2700,2800,2900,3000,3900,2400,3500
5160 GOTO 5100
5200 ' MENU COPY
5210 A$="444556460910"
5215 MID$(A$,7,2)=RIGHT$(STR$(45+OL),2)
5220 GOSUB 9000:IF MC=0 THEN RETURN
5230 DO=2
5240 ON MC GOSUB 3100,3200,,3600,6000,3300
5250 GOTO 5200
6000 ' MENU DISCO
6010 IF DO=1 THEN DT$=".PIC"
6011 IF DO=2 THEN DT$=".CPY"
6020 A$="22232425":GOSUB 9000
6155 'ON ERROR GOTO 7500
6160 ON MC GOTO 6170,6220,6270,6275
6170 ' SAVE
6175 DN$="SAVE"
6180 GOSUB 8000
6185 IF N$="" THEN 6000
6186 N$=N$+DT$
6190 IF DO=1 THEN BSAVE N$,0,&HFAA0,S
6195 IF DO=2 THEN COPY (0,0)-(XL,YL),1 TO N$
6210 GOTO 6280
6220 ' LOAD
6225 DN$="LOAD"
6230 GOSUB 8000
6235 IF N$="" THEN 6000
6236 N$=N$+DT$
6240 IF DO=1 THEN BLOAD N$,S
6250 IF DO=2 THEN COPY N$ TO (0,0),1
6260 GOTO 6280
6270 ' FILES
6271 GOTO 6280
6275 ' KILL
6276 GOTO 6280
6279 ' FIN DISCO
6280 ON ERROR GOTO 0:RETURN
7499 ' ERROR DISK
7500 PSET(190,0):PRINT#1," ERROR "
7510 IF ERR=53 THEN ER$="NOTFOUND"
7520 IF ERR=56 THEN ER$="BAD NAME"
7530 IF ERR=66 THEN ER$="DISKFULL"
7540 IF ERR=70 THEN ER$="OFF LINE"
7550 IF ERR=68 THEN ER$="PROTECTE"
7560 IF ERR=690 THEN ER$="I/OERROR"
7570 PSET(190,10):PRINT#1,ERR
7580 PSET(190,20):PRINT#1,ER$
7590 FOR F=1 TO 1000:NEXT
7600 RESUME 7610
7610 LINE(190,0)-(255,40),14,BF:RETURN
8000 ' Interface Disk-User
8010 MD=INT((((ABS(144-248)+1)*(ABS(1-39)+1)*8+7)/8+4)/2)+1
8020 ERASE P%:DIM P%(MD)
8030 COPY (144,1)-(248,39) TO P%:LINE(144,1)-(248,39),15,BF:LINE(144,1)-(248,39),1,B:LINE(146,3)-(246,37),1,B
8040 LINE(148,14)-(244,14):LINE(148,25)-(244,25)
8050 PSET(180,5):PRINT#1,DN$
8060 PSET(164,16):PRINT#1,"¨Nombre?"
8065 PSET(214,27):PRINT#1,DT$
8070 FOR F=1 TO 200:A$=INKEY$:NEXT
8080 L=0:N$=""
8090 A$=INKEY$:IF A$=""THEN 8090
8100 IF A$=CHR$(8) AND L>0 THEN L=L-1:N$=LEFT$(N$,L):PSET(148+L*8,27):PRINT#1," "
8110 IF ASC(A$)>48 AND ASC(A$)<122 AND LEN(N$)<8 THEN N$=N$+A$:L=L+1
8120 IF LEN(N$)>0 THEN PSET(149,27):PRINT#1,N$
8130 IF A$=CHR$(13) THEN 8150
8140 GOTO 8090
8150 COPY P% TO (144,1):RETURN
9000 ' MENU ESCOGE
9001 PUT SPRITE 0,(0,212)
9002 MM=LEN(A$)/4
9005 MD=INT((((ABS(198-234)+1)*(ABS(1-(MM*16+4))+1)*8+7)/8+4)/2)+1
9006 ERASE P%:DIM P%(MD)
9010 COPY (198,1)-(234,MM*16+4) TO P%:LINE(198,1)-(234,MM*16+4),255,BF:LINE(198,1)-(234,MM*16+4),1,B
9011 FOR F=1 TO MM
9014 PUT SPRITE F*2-1,(200,(F-1)*16+2),1,VAL(MID$(A$,F*4-3,2))
9015 PUT SPRITE F*2,(217,(F-1)*16+2),1,VAL(MID$(A$,F*4-1,2))
9016 NEXT F
9040 A=STICK(0) OR STICK(1):MX=MX+(A=7)-(A=3):MY=MY+(A=1)-(A=5)
9050 N=PAD(12):MX=MX+(PAD(13)<-6)-(PAD(13)>6):MY=MY+(PAD(14)<-6)-(PAD(14)>6)
9070 IF MX>1 THEN MX=1
9080 IF MX<0 THEN MX=0
9090 IF MY>MM-1 THEN MY=MM-1
9100 IF MY<0 THEN MY=0
9104 PUT SPRITE 31,(200+MX*17,2+MY*16),8,63
9105 FOR F=1 TO 70:NEXT
9110 IF STRIG(0) OR STRIG(1) OR STRIG(3) OR STRIG(4) THEN 9115 ELSE 9040
9115 IF STRIG(3) OR STRIG(4) THEN MC=0:GOTO 9130
9120 MC=MX+1+(MY*2)
9130 FOR F=1 TO 31:PUT SPRITE F,(0,212):NEXT
9135 COPY P% TO (198,1),0
9140 RETURN
10000 ' INICIO
10001 KEY 10,"GOTO 20000"
10003 SCREEN 8,2,0:GOSUB 3900
10004 BLOAD"LIZ.spr",S,&H7800
10005 DIM P%(365)
10015 OPEN"GRP:" FOR OUTPUT AS#1
10020 XC=99:YC=52:IX=1:IY=1:MN=0:MS=211:ME=255:MO=0:ID=2:TP=1:CO=255:CC=14:IC=1:TF=1:OL=1
10150 'COPY"op.md4" TO (50,0)
10160 GOTO 5000
20000 ' SAVE CON BACKUP
20010 NAME"WARHOL8.BAK" AS "WARHOL8.BAD"
20015 NAME"WARHOL8.BAS" AS "WARHOL8.BAK"
20020 KILL "WARHOL8.BAD"
20030 SAVE"WARHOL8.BAS"
