10 '  GENERADOR DE MACRO SPRITES
20 GOTO 1000
30 ON M GOTO 40,50,60
40 RETURN
50 CC=40:GOTO70
60 CC=33
70 ON S GOTO 100,110,120,130,140
100 XC=17-X:YC=Y:GOSUB 200:GOTO 140
110 XC=X:YC=17-Y:GOSUB 200:GOTO 140
120 XC=17-X:YC=17-Y:GOSUB 200:GOTO 140
130 XC=17-X:YC=Y:GOSUB 200:XC=X:YC=17-Y:GOSUB 200:XC=17-X:YC=17-Y:GOSUB 200
140 XC=X:YC=Y:GOSUB 200:RETURN
200 VPOKE 6305+XC+YC*32,CC
210 D=USR1(SN%)
260 RETURN
999 '
1000 ' MAIN
1001 A$="S4M4000CR16C+R16DR16C+"
1002 PLAY A$+A$
1010 CLEAR 200,49999!
1015 IF PEEK(54020!)<>58 THEN BLOAD"DEFSPR"
1020 KEY OFF:COLOR 7,1,1
1030 SCREEN 1,2,0:VDP(1)=226
1031 LOCATE 7,0:PRINT"ESPERE POR FAVOR"
1034 VPOKE 264,255:VPOKE 271,255
1035 FOR F=265 TO 270:VPOKE F,129:NEXT
1036 FOR F=320 TO 327:VPOKE F,255:NEXT
1037 FOR F=1000 TO 1007:VPOKE F,0:NEXT
1038 VPOKE 8207,&H11:CF=1
1040 DIM M(4,7,7):DIM C(31)
1045 FOR F=0 TO 31:C(F)=15:NEXT
1050 FOR F=1 TO 8:READ A$:S$=S$+CHR$(VAL("&H"+A$)):NEXT
1051 SPRITE$(32)=S$
1052 DATA 18,18,18,FF,FF,18,18,18
1060 S$="":FOR F=1 TO 32:READ A$:S$=S$+CHR$(VAL("&H"+A$)):NEXT
1061 SPRITE$(33)=S$
1062 DATA FF,80,80,80,80,80,80,80,80,80,80,80,80,80,80,FF,FF,01,01,01,01,01,01,01,01,01,01,01,01,01,01,FF
1070 DATA 18,18,18,FF,FF,18,18,18
1071 SX=28:SY=108:SC=14:SN%=1:SP=1
1072 M=1:S=5:M$="MOV":S$="OFF":VI%=0
1073 XM=1:YM=1:H=0:X=1:Y=1:CC=40:ID=1
1080 GOSUB 8100:GOSUB 8200:M(0,1,1)=1
1090 DEFUSR1=54020!:DEFUSR2=54124!:DEFUSR3=54193!:DEFUSR4=54433!:DEFUSR5=54507!:DEFUSR6=54555!:DEFUSR7=54580!:DEFUSR8=54611!:DEFUSR9=54641!
1100 FOR F=14 TO 23:LOCATE 17,F:PRINT STRING$(10,CHR$(125));:NEXT
1111 LOCATE 7,0:PRINT"                "
1260 ' main menu
1270 GOSUB 9030
1280 MC=6:GOSUB 8000
1300 ON YC GOSUB 2300,4000,5000,7000,6200,6400
1310 GOTO 1260
1400 X=1:IF XM=5 OR VI%=0 THEN X=16:RETURN
1402 XM=XM+1:SX=SX+16
1405 IF M(H,XM,YM)=255 THEN 5100
1410 SN%=M(H,XM,YM)
1420 D=USR2(SN%)
1430 SP=SN%
1440 LOCATE 0,2:PRINT"SPRITE=";SN%;" "
1444 PUT SPRITE 0,(100,8),14,SN%
1445 RETURN
1450 X=16:IF XM=1 OR VI%=0 THEN X=1:RETURN
1452 XM=XM-1:SX=SX-16
1455 IF M(H,XM,YM)=255 THEN 5100
1460 SN%=M(H,XM,YM)
1470 D=USR2(SN%)
1480 SP=SN%
1490 LOCATE 0,2:PRINT"SPRITE=";SN%;" "
1494 PUT SPRITE 0,(100,8),14,SN%
1495 RETURN
1500 Y=1:IF YM=5 OR VI%=0 THEN Y=16:RETURN
1502 YM=YM+1:SY=SY+16
1505 IF M(H,XM,YM)=255 THEN 5100
1510 SN%=M(H,XM,YM)
1520 D=USR2(SN%)
1530 SP=SN%
1540 LOCATE 0,2:PRINT"SPRITE=";SN%;" "
1544 PUT SPRITE 0,(100,8),14,SN%
1545 RETURN
1550 Y=16:IF YM=1 OR VI%=0 THEN Y=1:RETURN
1552 YM=YM-1:SY=SY-16
1555 IF M(H,XM,YM)=255 THEN 5100
1560 SN%=M(H,XM,YM)
1570 D=USR2(SN%)
1580 SP=SN%
1590 LOCATE 0,2:PRINT"SPRITE=";SN%;" "
1594 PUT SPRITE 0,(100,8),14,SN%
1595 RETURN
1900 ON ID GOTO 2000,7500,6500
2000 ' DIBUJO
2001 D=USR2(SN%)
2002 PUT SPRITE 31,(X*8+8,Y*8+39),2,32
2004 LOCATE 0,2:PRINT"SPRITE=";SN%;" "
2006 PUT SPRITE 0,(100,8),14,SN%
2010 GOSUB 9120
2020 A=STICK(0) OR STICK(1):IF A<>0 THEN 2100
2030 IF STRIG(0) OR STRIG(1)<>0 THEN 2200
2040 IF INKEY$=CHR$(13) THEN 2300
2050 GOTO 2020
2100 ' CURSOR
2110 X=X-((A=2)OR(A=3)OR(A=4))+((A=6)OR(A=7)OR(A=8))
2120 Y=Y-((A=4)OR(A=5)OR(A=6))+((A=1)OR(A=2)OR(A=8))
2130 IF X>16 THEN GOSUB 1400
2140 IF X<1 THEN GOSUB 1450
2150 IF Y>16 THEN GOSUB 1500
2160 IF Y<1 THEN GOSUB 1550
2170 PUT SPRITE 31,(X*8+8,Y*8+39),2,32
2180 GOSUB 30:GOTO 2020
2200 ' DISPARO
2210 IF VPEEK(6305+X+Y*32)=33 THEN CC=40 ELSE CC=33
2220 GOSUB 70
2230 IF STRIG(0) OR STRIG(1)<>0 THEN 2230
2240 GOTO 2020
2300 ' OPCIONES
2310 GOSUB 9230
2311 D=USR2(SN%)
2315 MC=12:GOSUB 8000
2320 ON YC GOTO 1900,2400,2500,2700,2650,3100,3200,3300,2800,3000,2900,2780
2350 IF STRIG(0) OR STRIG(1) THEN 2970
2400 '  MODO
2410 M=M+1:IF M>3 THEN M=1
2420 ON M GOTO 2430,2440,2450
2430 M$="MOV":GOTO 2460
2440 M$="DIB":GOTO 2460
2450 M$="BOR"
2460 LOCATE 23,3:PRINTM$;
2465 YC=2:GOSUB 8015:GOTO 2320
2470 GOTO 2315
2500 '  SIMETRIA
2520 S=S+1:IF S>5 THEN S=1
2530 ON S GOTO 2540,2550,2560,2580,2590
2540 S$=" V ":GOTO 2600
2550 S$=" W ":GOTO 2600
2560 S$=" / ":GOTO 2600
2580 S$=" U ":GOTO 2600
2590 S$="OFF"
2600 LOCATE 22,4:PRINTS$
2610 YC=3:GOSUB 8015:GOTO 2320
2650 GOSUB 8200
2660 D=USR1(SN%)
2690 GOTO 2300
2700 ' INVERSION
2710 D=USR7(0):D=USR2(SN%):GOTO 2300
2780 ' VUELVE A MAIN MENU
2790 RETURN
2800 ' CAMBIA NUMERO SPRITE
2810 GOSUB 8400
2820 D=USR2(SN%)
2830 GOTO 2300
2900 ' CAMBIO DE PLANO
2910 A=STICK(0) OR STICK(1)
2920 H=H+(A=7)-(A=3)
2930 IF H<0 THEN H=0 ELSE IF H>4 THEN H=4
2940 LOCATE 18,0:PRINT"Ï PLANO? ";H
2950 IF STRIG(0) OR STRIG(1) THEN 2965
2960 GOTO 2910
2965 IF M(H,XM,YM)=255 THEN LOCATE 0,0:PRINT"MACRO VACIO":FOR F=1 TO 1000:NEXT:LOCATE 0,0:PRINT"           ":GOTO 2910
2970 SP=M(H,XM,YM):SN%=SP
2980 D=USR2(SN%)
2985 PUT SPRITE 31,(160,167),15,SN%
2986 LOCATE 0,2:PRINT"SPRITE=";SN%;" "
2990 GOTO 2300
3000 ' COPIA SPRITE
3010 GOSUB 8400
3020 D=USR1(SN%):GOTO 2300
3100 ' SCROLL
3110 D=USR3(STICK(0)):D=USR2(SN%)
3120 IF STRIG(0) THEN 2300 ELSE 3110
3200 ' GIRO
3210 D=USR4(0):D=USR1(SN%):GOTO 2300
3300 ' ESPEJO
3310 D=USR5(0):D=USR1(SN%):GOTO 2300
4000 ' DISCO
4010 GOSUB 9340
4020 'ON ERROR GOTO 4700
4030 MC=5:GOSUB 8000:OD=YC:IF YC=5 THEN RETURN
4032 GOSUB 9510:MC=5:GOSUB 8000:IF YC=5 THEN 4000
4034 IF OD<>3 THEN GOSUB 4600:IF N$="" THEN 4000
4036 ON YC GOSUB 4040,7700,7800,7900
4038 GOTO 4000
4040 ON OD GOSUB 4100,4200,4300,4400,4500
4050 RETURN
4100 ' SALVAR
4110 GOSUB 9000
4120 LOCATE 18,0:PRINT"SALVANDO"
4130 W$=N$+".SPR"
4135 LOCATE 18,0:PRINT"SALVANDO"
4150 DI=30720:DF=DI+32*64
4160 BSAVE W$,DI,DF,S
4170 RETURN
4200 ' CARGAR
4210 GOSUB 9000
4220 LOCATE 18,0:PRINT"CARGAND0"
4230 W$=N$+".SPR"
4235 LOCATE 18,2:PRINT W$
4250 DI=30720:DF=DI+32*64
4260 BLOAD W$,S
4265 D=USR2(SN%)
4270 RETURN
4300 ' LISTAR?
4310 CLS:FILES"*.spr"
4315 IF INKEY$<>"" THEN 4315
4320 IF INKEY$="" THEN 4320
4325 CLS:D=USR2(SN%)
4330 RETURN
4400 ' BORRAR
4410 GOSUB 9000
4420 LOCATE 18,0:PRINT"BORRANDO"
4430 W$=N$+".SPR"
4435 LOCATE 18,2:PRINT W$
4450 KILL W$
4460 RETURN
4500 GOSUB 9000:RETURN
4600 ' PIDE NOMBRE
4601 GOSUB 9000
4605 FOR F=1 TO 200:Z$=INKEY$:NEXT
4606 LOCATE 18,2:PRINT"NOMBRE?"
4610 L=0:N$=""
4620 A$=INKEY$:IF A$="" THEN 4620
4630 IF A$=CHR$(8) AND L>0 THEN L=L-1:N$=LEFT$(N$,L)
4640 IF ASC(A$)>48 AND ASC(A$)<122 THEN N$=N$+A$:L=L+1
4650 LOCATE 18,4:PRINTN$+"   "
4660 IFA$=CHR$(13) THEN 4680
4670 GOTO 4620
4680 IF LEN(N$)>8 THEN  PSET(130,40):PRINT#1,"            ":GOTO 4600
4690 RETURN
4700 ' ERRORES
4710 GOSUB 9000
4720 LOCATE 18,0:PRINT "ERROR"
4730 IF ERR=53 THEN ER$="NO EXISTE"
4740 IF ERR=56 THEN ER$="MAL NOMBRE"
4750 IF ERR=66 THEN ER$="DISCO LLENO"
4760 IF ERR=70 THEN ER$="NO HAY DISCO"
4770 IF ERR=690 THEN ER$="ERROR I/O"
4780 IF ERR=68 THEN ER$="PROTEGIDO"
4790 LOCATE 18,2:PRINT ERR
4795 LOCATE 18,4:PRINT ER$
4800 FOR F=1 TO 1000:NEXT
4810 RESUME 4820
4820 GOTO 4000
5000 ' MACROS
5010 GOSUB 9430
5020 MC=4:GOSUB 8000
5030 ON YC GOTO 5400,5600,5200,5040
5040 D=USR2(SN%):RETURN
5099 ' MACREO VACIO
5100 GOSUB 8200
5110 PUT SPRITE 0,(160,212)
5120 LOCATE 0,2:PRINT"MACRO VACIO    "
5121 PUT SPRITE 31,((XM-1)*16+152,(YM-1)*16+110),14,33
5125 A=STICK(0) OR STICK(1):IF A<>0 THEN 5125
5130 A=STICK(0) OR STICK(1)
5140 IF A=3THEN IFXM<5 THEN LOCATE 0,0:PRINT"             ":X=1:GOTO1402
5141 IF A=7THEN IFXM>1 THEN LOCATE 0,0:PRINT"             ":X=16:GOTO1452
5142 IF A=5THEN IFYM<5 THEN LOCATE 0,0:PRINT"             ":Y=1:GOTO1502
5143 IF A=1THEN IFYM>1 THEN LOCATE 0,0:PRINT"             ":Y=16:GOTO1552
5150 GOTO 5130
5200 ' BORRA MACRO
5210 GOSUB 8100:XM=1:YM=1:H=0:SX=28:SY=108:SN%=1:SP=1
5220 FOR F=1 TO 31:PUT SPRITE F,(0,220):NEXT
5230 GOTO 5000
5400 ' ASIGNA MACROS
5410 GOSUB 8400:BEEP
5411 IF VI%=0 THEN VI%=1
5412 LOCATE 18,2:PRINT"ESPERE"
5420 FOR N%=0 TO 4:FOR G%=0 TO 7:FOR K%=0 TO 7
5425 IF M(N%,G%,K%)=F THEN M(N%,G%,K%)=255
5430 NEXT K%:NEXT G%:NEXT N%:BEEP
5435 FOR N=1 TO 200:Z$=INKEY$:NEXT
5440 LOCATE 18,0:PRINT"       "
5443 LOCATE 18,2:PRINT"COORDS"
5444 LOCATE 18,3:PRINT"X="
5445 L=0:A$=""
5450 A$=INKEY$:IF A$="" THEN 5450
5460 IF ASC(A$)>48 AND ASC(A$)<54 THEN 5470 ELSE 5450
5470 LOCATE 20,3:PRINT A$
5480 FOR N=1 TO 500:NEXT:XC=VAL(A$)
5490 LOCATE 18,4:PRINT"Y="
5500 L=0:A$=""
5510 A$=INKEY$:IF A$="" THEN 5510
5520 IF ASC(A$)>48 AND ASC(A$)<54 THEN 5530 ELSE 5510
5530 LOCATE 20,4:PRINT A$
5540 FOR N=1 TO 500:NEXT:YC=VAL(A$)
5545 IF M(H,XC,YC)<>255 THEN PUT SPRITE M(H,XC,YC),(0,212)
5550 M(H,XC,YC)=F:XM=XC:YM=YC
5555 SX=(XC-1)*16+152:SY=(YC-1)*16+110
5556 SN=F:SP=SN
5557 PUT SPRITE F,(SX,SY),C(F),F
5560 GOTO 5000
5600 ' CAMBIO DE PLANO
5640 A=STICK(0) OR STICK(1)
5650 H=H+(A=7)-(A=3)
5660 IF H<0 THEN H=0 ELSE IF H>4 THEN H=4
5665 LOCATE 18,0:PRINT"Ï PLANO? ";H
5670 IF STRIG(0) OR STRIG(1) THEN 5678
5675 GOTO 5640
5680 GOTO 5000
6200 ' COLORES
6210 GOSUB 9000:SZ=SN
6220 LOCATE 18,0:PRINT"SPRITE?"
6230 A=STICK(0) OR STICK(1)
6240 SZ=SZ+(A=7)-(A=3)
6250 IF SZ<1 THEN SZ=0 ELSE IF SZ>31 THEN SZ=31
6260 IF STRIG(0) OR STRIG(1) THEN 6300
6270 LOCATE 18,0:PRINT"SPRITE=";SZ;" "
6280 PUT SPRITE 0,(160,80),C(SZ),SZ
6290 GOTO 6230
6300 C=C(SZ)
6305 IF STRIG(0) OR STRIG(1) THEN 6305
6310 LOCATE 18,2:PRINT"COLOR?"
6320 A=STICK(0) OR STICK(1)
6330 C=C+(A=7)-(A=3)
6340 IF C<1 THEN C=Z ELSE IF C>15 THEN C=15
6350 IF STRIG(0) OR STRIG(1) THEN 6390
6360 LOCATE 18,3:PRINT C;" "
6370 PUT SPRITE 0,(160,80),C,SZ
6375 'COLOR SPRITE(SZ)=C
6380 GOTO 6320
6390 C(SZ)=C:'COLOR SPRITE(SZ)=C
6395 GOSUB 9000:RETURN
6400 ' FONDO
6405 GOSUB 9000
6410 IF STRIG(0) OR STRIG(1) THEN 6410
6420 A=STICK(0) OR STICK(1)
6430 CF=CF+(A=7)-(A=3)
6440 IF CF<1 THEN CF=Z ELSE IF CF>15 THEN CF=15
6450 VPOKE 8207,16+CF
6455 LOCATE 18,0:PRINT"COLOR ";CF;" "
6460 IF STRIG(0) OR STRIG(1) THEN 6480
6470 FOR F=1 TO 100:NEXT:GOTO 6410
6480 RETURN
6500 'PAD
6510 GOSUB 9000
6520 LOCATE 18,0:PRINT"TABLETA"
6535 IF STRIG(0) OR STRIG(1) THEN 2300
6536 IF INKEY$=CHR$(13) THEN 2300
6540 IF PAD(4)=0 THEN PUT SPRITE 0,(0,212):GOTO 6535
6550 X=INT(PAD(5)/14):Y=INT(PAD(6)/14)
6560 IF X>16 THEN GOSUB 1400
6570 IF X<1 THEN GOSUB 1450
6580 IF Y>16 THEN GOSUB 1500
6590 IF Y<1 THEN GOSUB 1550
6600 PUT SPRITE 0,(X*6+13,Y*6-8),14,0
6610 PUT SPRITE SP,(SX,SY),C(SN),SN
6625 IF M=1 AND PAD(7)=-1 THEN GOTO 6630
6626 IF PAD(7)=-1 THEN GOSUB 30
6628 GOTO6535
6630 ' DISPARO
6640 IF POINT(X*6+16,Y*6-5)=1 THEN CC=2 ELSE CC=1
6650 GOSUB 70
6680 GOTO 6535
7000 ' ANIMACION
7010 BEEP:RETURN
7332 IF INKEY$<>"" THEN 7332
7500 ' RATON
7510 GOSUB 9000
7520 LOCATE 18,0:PRINT"RATON"
7525 X=1:Y=1
7535 IF STRIG(0) OR STRIG(1) THEN 2300
7536 IF INKEY$=CHR$(13) THEN 2300
7540 F=PAD(12)
7550 X=X-(PAD(13)>0)+(PAD(13)<0):Y=Y-(PAD(14)>0)+(PAD(14)<0)
7560 IF X>16 THEN GOSUB 1400
7570 IF X<1 THEN GOSUB 1450
7580 IF Y>16 THEN GOSUB 1500
7590 IF Y<1 THEN GOSUB 1550
7600 PUT SPRITE 0,(X*6+13,Y*6-8),14,0
7610 PUT SPRITE SP,(SX,SY),C(SN),SN
7625 IF M=1 AND STRIG(3)=-1 THEN GOTO 7630
7626 IF STRIG(3)=-1 THEN GOSUB 30
7628 GOTO7535
7630 ' DISPARO
7640 IF POINT(X*6+16,Y*6-5)=1 THEN CC=2 ELSE CC=1
7650 GOSUB 70
7680 GOTO 7535
7700 ' DISCO MACROS
7701 W$=N$+".MAC":GOSUB 9000
7702 ON OD GOTO 7710,7720,7730,7740
7710 LOCATE 18,0:PRINT"SALVANDO":LOCATE 18,2:PRINT W$:OPEN W$ FOR OUTPUT AS#1
7711 FOR F=0 TO 4:FOR G=0 TO 7:FOR K=0 TO 7
7712 PRINT#1,STR$(M(F,G,K));",";
7713 NEXT K:NEXT G:NEXT F
7714 PRINT#1,STR$(H);",";STR$(XM);",";STR$(YM):CLOSE#1
7715 RETURN
7720 LOCATE 18,0:PRINT"CARGANDO":LOCATE 18,2:PRINT W$:OPEN W$ FOR INPUT AS#1
7721 FOR F=0 TO 4:FOR G=0 TO 7:FOR K=0 TO 7
7722 INPUT#1,A$
7723 M(F,G,K)=VAL(A$):IF M(F,G,K)=255THEN 7724 ELSE PUT SPRITE M(F,G,K),(116+G*16,112+K*16)
7724 NEXT K:NEXT G:NEXT F
7725 INPUT#1,A$:H=VAL(A$):INPUT#1,A$:XM=VAL(A$):INPUT#1,A$:YM=VAL(A$)
7726 SX=XM*16+12:SY=YM*16+92:SP=M(H,XM,YM):SN=SP:CS=C(SP)
7727 CLOSE#1:RETURN
7730 ' LISTAR?
7731 CLS:FILES"*.mac"
7732 IF INKEY$="" THEN 7732
7733 IF INKEY$="" THEN 7733
7734 CLS:D=USR2(SN%):RETURN
7740 LOCATE 18,0:PRINT"BORRANDO":LOCATE 18,2:PRINT W$:KILL W$
7741 RETURN
7800 ' DISCO COLORES
7801 W$=N$+".COL":GOSUB 9000
7802 ON OD GOTO 7810,7820,7830,7840
7810 LOCATE 18,0:PRINT"SALVANDO":LOCATE 18,2:PRINT W$:OPEN W$ FOR OUTPUT AS#1
7811 FOR F=0 TO 31
7812 PRINT#1,CHR$(C(F));",";
7813 NEXT F
7814 CLOSE#1
7815 RETURN
7820 LOCATE 18,0:PRINT"CARGANDO":LOCATE 18,2:PRINT W$:OPEN W$ FOR INPUT AS#1
7821 FOR F=0 TO 31
7822 INPUT#1,A$
7823 C(F)=ASC(A$):VPOKE BASE(13)+F*4+3,C(F)
7824 NEXT F
7825 CLOSE#1
7826 RETURN
7830 ' LISTAR?
7831 CLS:FILES"*.col"
7832 IF INKEY$<>"" THEN 7832
7833 IF INKEY$="" THEN 7833
7834 CLS:D=USR2(SN%):RETURN
7840 LOCATE 18,0:PRINT"BORRANDO":LOCATE 18,2:PRINT W$:KILL W$
7841 RETURN
7900 ' DISCO TODO
7910 GOSUB 4040:GOSUB 7700:GOSUB 7800:RETURN
8000 ' DETECTA MENUS
8010 YC=1
8015 IZ=0
8020 LOCATE 17,YC+1:PRINT"Ï"
8030 IF STRIG(0) OR STRIG(1) OR IZ=1 THEN BEEP:LOCATE 17,YC+1:PRINT" ": RETURN
8035 F=PAD(12):G=PAD(14)
8040 A=STICK(0) OR STICK(1):IF A=0 THEN 8030
8045 LOCATE 17,YC+1:PRINT" "
8050 YC=YC+((A=1)OR(G<-5))-((A=5)OR(G>5))
8060 IF YC<1 THEN YC=MC ELSE IF YC>MC THEN YC=1
8070 FOR F=1 TO 50:NEXT
8080 GOTO 8020
8100 ' CLEAR MACRO
8110 FOR F=0 TO 4
8120 FOR G=0 TO 7
8130 FOR K=O TO 7
8140 M(F,G,K)=255
8150 NEXT K:NEXT G:NEXT F
8160 RETURN
8200 ' CLS GRID
8210 FOR F=6 TO 21:LOCATE 0,F:PRINT"!!!!!!!!!!!!!!!!":NEXT
8220 RETURN
8400 ' ELIGE N. SPRITE
8410 GOSUB 9000
8430 F=SN%
8440 A=STICK(0) OR STICK(1)
8450 F=F+(A=7)-(A=3)
8460 IF F<0 THEN F=0 ELSE IF F>63 THEN F=63
8470 IF STRIG(0) OR STRIG(1) THEN SN%=F:SP=F:RETURN
8480 LOCATE 0,2:PRINT"SPRITE=";F;" "
8490 PUT SPRITE 0,(100,8),14,F
8495 FOR G=1 TO 30:NEXT
8500 GOTO 8440
9000 ' BORRA MENUS
9010 FOR F=0 TO 13:LOCATE 18,F:PRINTSPACE$(11):NEXT
9020 RETURN
9030 ' MAIN MENU
9040 GOSUB 9000
9050 LOCATE 18,0:PRINT"MAIN MENU"
9060 LOCATE 18,2:PRINT"DIBUJO"
9070 LOCATE 18,3:PRINT"DISCO"
9080 LOCATE 18,4:PRINT"MACROS"
9090 LOCATE 18,5:PRINT"ANIMACION"
9100 LOCATE 18,6:PRINT"COLORES"
9105 LOCATE 18,7:PRINT"FONDO"
9110 RETURN
9120 '  MENU DIBUJO
9130 GOSUB 9000
9140 LOCATE 18,2:PRINT" DIBUJO"
9150 LOCATE 18,3:PRINT"CURSORES"
9160 LOCATE 18,4:PRINT"JOYSTICK"
9180 LOCATE 18,5:PRINT" "
9190 LOCATE 18,6:PRINT" RETURN"
9200 LOCATE 18,7:PRINT"  PARA"
9210 LOCATE 18,8:PRINT"OPCIONES"
9220 RETURN
9230 '  MENU OPCIONES DIBUJO
9240 GOSUB 9000
9250 LOCATE 18,0:PRINT"OPCIONES"
9251 LOCATE 18,2:PRINT"DIBUJO"
9260 LOCATE 18,3:PRINT"MODO:"
9265 LOCATE 23,3:PRINTM$
9270 LOCATE 18,4:PRINT"SIM."
9275 LOCATE 22,4:PRINTS$
9280 LOCATE 18,5:PRINT"INVERSION"
9290 LOCATE 18,6:PRINT"BORRADO"
9291 LOCATE 18,7:PRINT"SCROLL"
9292 LOCATE 18,8:PRINT"GIRO"
9293 LOCATE 18,9:PRINT"ESPEJO"
9300 LOCATE 18,10:PRINT"COPIA"
9310 LOCATE 18,11:PRINT"ALMACENA"
9320 LOCATE 18,12:PRINT"PLANO ";H
9321 LOCATE 18,13:PRINT"MAIN MENU"
9330 BEEP:RETURN
9340 '  MENU DISCO
9350 GOSUB 9000
9360 LOCATE 18,0:PRINT"DISCO"
9370 LOCATE 18,2:PRINT"SALVAR"
9380 LOCATE 18,3:PRINT"CARGAR"
9390 LOCATE 18,4:PRINT"LISTAR"
9400 LOCATE 18,5:PRINT"BORRAR"
9410 LOCATE 18,6:PRINT"MAIN MENU"
9420 BEEP:RETURN
9430 '  MENU MACROS
9440 GOSUB 9000
9450 LOCATE 18,0:PRINT"MACROS"
9470 LOCATE 18,2:PRINT"MACROS"
9480 LOCATE 18,3:PRINT"PLANO: ";H
9490 LOCATE 18,4:PRINT"BORRAR"
9495 LOCATE 18,5:PRINT"SALIR"
9500 RETURN
9510 '  MENU TIPO DISCO
9520 GOSUB 9000
9530 LOCATE 18,0:PRINT"TIPO?"
9540 LOCATE 18,2:PRINT"SPRITES"
9550 LOCATE 18,3:PRINT"MACROS"
9560 LOCATE 18,4:PRINT"COLORES"
9570 LOCATE 18,5:PRINT"TODO"
9580 LOCATE 18,6:PRINT"SALIR"
9590 RETURN
